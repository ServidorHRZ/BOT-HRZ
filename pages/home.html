<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BOT DE PRONÓSTICOS HRZ - Home</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #6deb32;
            --primary-hover: #44af0e;
            --bg-gradient: linear-gradient(45deg, #000000, #111111);
            --shadow-color: rgba(56, 176, 0, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background: var(--bg-gradient);
            min-height: 100vh;
            color: #fff;
        }

        .navbar {
            background: rgba(0, 0, 0, 0.8);
            padding: 1rem 2rem;
            border-bottom: 1px solid rgba(56, 176, 0, 0.1);
        }

        .navbar-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            color: var(--primary-color);
            font-size: 1.5rem;
            font-weight: 700;
        }

        .main-content {
            max-width: 1200px;
            margin: 0.2rem auto;
            padding: 0.5rem;
        }

        .welcome-card, .stat-card {
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid rgba(56, 176, 0, 0.1);
        }

        .welcome-card {
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 0.2rem;
        }

        .welcome-card h1 {
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .stat-card {
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0, 255, 0, 0.2);
        }

        .stat-card h3 {
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        .logout-btn {
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
            background: transparent;
            padding: 0.6rem 1.2rem;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: var(--primary-color);
            color: white;
            box-shadow: 0 4px 15px var(--shadow-color);
        }

        .logout-btn i {
            font-size: 1.2rem;
        }

        .user-info {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .user-header {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .user-header i {
            font-size: 3.5rem;
            color: var(--primary-color);
        }

        .user-details h1 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }

        .subscription-info {
            display: flex;
            gap: 2rem;
            font-size: 1.1rem;
        }

        .subscription-info i {
            color: var(--primary-color);
            margin-right: 0.5rem;
        }

        .status-active {
            color: var(--primary-color);
            font-weight: 600;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin: 1.5rem 0;
            max-width: 900px;
            margin-left: auto;
            margin-right: auto;
        }

        .action-btn {
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid var(--primary-color);
            color: #fff;
            padding: 1rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            height: 80px;
        }

        .action-btn i {
            font-size: 1.5rem;
            color: var(--primary-color);
            flex-shrink: 0;
        }

        .action-btn .btn-text {
            text-align: left;
            flex-grow: 1;
        }

        .action-btn span {
            display: block;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.2rem;
        }

        .action-btn small {
            display: block;
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.8rem;
        }

        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 15px rgba(109, 235, 50, 0.2);
            background: rgba(109, 235, 50, 0.1);
        }

        @media (max-width: 768px) {
            .action-buttons {
                grid-template-columns: 1fr;
            }
            
            .subscription-info {
                flex-direction: column;
                gap: 1rem;
            }
        }

        .user-avatar {
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(109, 235, 50, 0.1);
            border-radius: 50%;
            border: 2px solid var(--primary-color);
        }

        .user-avatar i {
            font-size: 2.5rem;
            color: var(--primary-color);
        }

        .plan-badge {
            display: inline-flex;
            align-items: center;
            background: rgba(109, 235, 50, 0.1);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            border: 1px solid var(--primary-color);
        }

        .plan-badge i {
            color: var(--primary-color);
            margin-right: 0.5rem;
            font-size: 1rem;
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            background: rgba(0, 0, 0, 0.3);
            padding: 1rem;
            border-radius: 10px;
            border: 1px solid rgba(109, 235, 50, 0.1);
        }

        .info-label {
            display: block;
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }

        .info-value {
            display: block;
            color: var(--primary-color);
            font-weight: 600;
        }

        .content-section {
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid rgba(109, 235, 50, 0.1);
            border-radius: 15px;
            padding: 1.5rem;
            margin: 0.5rem auto;
            max-width: 1200px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .section-header h2 {
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.8rem;
        }

        .section-header h2 i {
            background: rgba(109, 235, 50, 0.1);
            padding: 0.8rem;
            border-radius: 12px;
            font-size: 1.5rem;
        }

        .ver-mas-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(109, 235, 50, 0.1);
            color: var(--primary-color);
            padding: 0.5rem 1rem;
            border-radius: 4px;
            font-size: 0.9rem;
            text-decoration: none;
            border: 1px solid var(--primary-color);
            transition: all 0.3s ease;
        }

        .ver-mas-btn:hover {
            background: var(--primary-color);
            color: #000;
        }

        .ver-mas-btn i {
            font-size: 0.8rem;
        }

        .prediction-card, .results-card, .news-card {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(109, 235, 50, 0.1);
            border-radius: 12px;
            padding: 1.8rem;
            margin-bottom: 1.5rem;
            transition: all 0.3s ease;
        }

        .prediction-card:hover, .results-card:hover, .news-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 15px rgba(109, 235, 50, 0.1);
            background: rgba(0, 0, 0, 0.7);
        }

        .prediction-card h3, .results-card h3, .news-card h3 {
            color: var(--primary-color);
            font-size: 1.3rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .prediction-card p, .results-card p, .news-card p {
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.6;
            margin-bottom: 0.8rem;
        }

        .prediction {
            background: rgba(109, 235, 50, 0.1);
            padding: 0.8rem 1.2rem;
            border-radius: 8px;
            border-left: 4px solid var(--primary-color);
            font-weight: 500;
            margin-top: 1rem;
        }

        .result-item {
            display: flex;
            align-items: center;
            padding: 1rem;
            background: rgba(109, 235, 50, 0.05);
            border-radius: 8px;
            margin-bottom: 0.8rem;
        }

        .result-item .success {
            background: rgba(109, 235, 50, 0.1);
            padding: 0.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .result-item p {
            margin: 0;
        }

        .news-card {
            position: relative;
            overflow: hidden;
        }

        .news-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--primary-color);
            opacity: 0.5;
        }

        .tab-navigation {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin: 1rem auto;
            max-width: 800px;
            border-bottom: 1px solid rgba(109, 235, 50, 0.1);
            padding-bottom: 0;
        }

        .tab-btn {
            background: transparent;
            border: none;
            color: #fff;
            padding: 1rem 2rem;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            opacity: 0.7;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .tab-btn i {
            font-size: 1.2rem;
            color: var(--primary-color);
        }

        .tab-btn::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--primary-color);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .tab-btn:hover {
            opacity: 1;
        }

        .tab-btn.active {
            opacity: 1;
            font-weight: 600;
        }

        .tab-btn.active::after {
            transform: scaleX(1);
        }

        /* Actualizaciones para hacer la página responsiva */
        @media (max-width: 768px) {
            .navbar {
                padding: 0.8rem 1rem;
            }

            .navbar-content {
                flex-direction: column;
                gap: 1rem;
            }

            .logo {
                font-size: 1.2rem;
            }

            .main-content {
                padding: 0.5rem;
            }

            .welcome-card {
                padding: 1rem;
            }

            .user-header {
                flex-direction: column;
                text-align: center;
                gap: 1rem;
            }

            .user-details h1 {
                font-size: 1.4rem;
            }

            .subscription-info {
                flex-direction: column;
                gap: 1rem;
            }

            .info-item {
                flex-direction: column;
                text-align: center;
                gap: 0.5rem;
            }

            .tab-navigation {
                flex-direction: column;
                gap: 0.5rem;
                padding: 0 1rem;
            }

            .tab-btn {
                width: 100%;
                justify-content: center;
                padding: 0.8rem;
            }

            .section-header h2 {
                font-size: 1.4rem;
            }

            .prediction-card {
                padding: 1rem;
            }

            /* Ajustes para las predicciones de partidos */
            .probability-legend {
                flex-direction: column;
                align-items: center;
                gap: 0.5rem;
                text-align: center;
            }

            .additional-predictions {
                grid-template-columns: 1fr;
            }

            /* Ajustes para los detalles del partido */
            .prediction-card .grid-template-columns {
                grid-template-columns: 1fr !important;
                gap: 1rem !important;
            }

            .prediction-card img {
                width: 30px !important;
                height: 30px !important;
            }

            /* Ajuste para el VS */
            .prediction-card .vs-divider {
                margin: 0.5rem 0;
            }
        }

        @media (max-width: 480px) {
            .user-details h1 {
                font-size: 1.2rem;
            }

            .plan-badge {
                padding: 0.3rem 0.8rem;
                font-size: 0.9rem;
            }

            .section-header h2 {
                font-size: 1.2rem;
            }

            .prediction-card h3 {
                font-size: 1.1rem;
            }

            .probability-bar {
                height: 15px;
            }

            .prediction-item {
                padding: 0.8rem;
            }

            .probability-legend {
                font-size: 0.8rem;
            }
        }

        /* Ajustes para las barras de probabilidad */
        .probability-bar {
            height: 20px;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 15px;
            display: flex;
            background: rgba(255, 255, 255, 0.05);
        }

        .probability-bar div {
            transition: width 0.3s ease;
            position: relative;
        }

        .probability-bar div:first-child {
            background: linear-gradient(to right, rgba(109, 235, 50, 0.8), rgba(109, 235, 50, 0.9));
        }

        .probability-bar div:nth-child(2) {
            background: linear-gradient(to right, rgba(255, 215, 0, 0.8), rgba(255, 215, 0, 0.9));
        }

        .probability-bar div:last-child {
            background: linear-gradient(to right, rgba(255, 68, 68, 0.8), rgba(255, 68, 68, 0.9));
        }

        .probability-legend {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-size: 0.85rem;
            opacity: 0.9;
        }

        .probability-legend span {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .probability-legend span::before {
            content: '';
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .probability-legend span:first-child::before {
            background: #6deb32;
        }

        .probability-legend span:nth-child(2)::before {
            background: #ffd700;
        }

        .probability-legend span:last-child::before {
            background: #ff4444;
        }

        .news-category {
            margin-bottom: 2rem;
        }

        .category-title {
            color: var(--primary-color);
            font-size: 1.5rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(109, 235, 50, 0.2);
        }

        .view-more-btn {
            background: rgba(109, 235, 50, 0.1);
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .view-more-btn:hover {
            background: var(--primary-color);
            color: #000;
            transform: translateX(5px);
        }

        .view-more-btn i {
            font-size: 0.8rem;
            transition: transform 0.3s ease;
        }

        .view-more-btn:hover i {
            transform: translateX(3px);
        }

        @media (max-width: 768px) {
            .category-title {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }

            .view-more-btn {
                width: 100%;
                justify-content: center;
            }
        }

        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.2rem;
            margin-top: 1rem;
        }

        .news-card {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
            border: 1px solid rgba(109, 235, 50, 0.1);
            position: relative;
            height: auto;
            display: flex;
            flex-direction: column;
        }

        .news-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(109, 235, 50, 0.15);
            background: rgba(0, 0, 0, 0.6);
        }

        .news-image {
            position: relative;
            width: 100%;
            height: 200px;
            overflow: hidden;
        }

        .news-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .news-card:hover .news-image img {
            transform: scale(1.05);
        }

        .news-content {
            padding: 1.2rem;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            gap: 1rem;
        }

        .news-category-tag {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(109, 235, 50, 0.1);
            color: var(--primary-color);
            padding: 0.4rem 0.8rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 500;
            margin-bottom: 0.8rem;
        }

        .news-title {
            font-size: 1.2rem;
            font-weight: 600;
            line-height: 1.4;
            margin-bottom: 0.8rem;
            color: #fff;
        }

        .news-excerpt {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.5;
            margin-bottom: 1rem;
        }

        .news-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1rem;
            border-top: 1px solid rgba(109, 235, 50, 0.1);
        }

        .news-date {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.6);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .read-more {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary-color);
            font-size: 0.9rem;
            font-weight: 500;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            background: rgba(109, 235, 50, 0.1);
            transition: all 0.3s ease;
        }

        .read-more:hover {
            background: var(--primary-color);
            color: #000;
        }

        /* Estilos para las categorías */
        .news-categories-nav {
            display: flex;
            gap: 0.8rem;
            padding: 1rem 0;
            margin-bottom: 2rem;
            overflow-x: auto;
            scrollbar-width: none;
        }

        .news-categories-nav::-webkit-scrollbar {
            display: none;
        }

        .category-btn {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(109, 235, 50, 0.2);
            color: #fff;
            padding: 0.6rem 1.2rem;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            white-space: nowrap;
            user-select: none;
        }

        .category-btn:hover {
            background: rgba(109, 235, 50, 0.1);
            border-color: var(--primary-color);
        }

        .category-btn.active {
            background: var(--primary-color);
            color: #000;
            border-color: var(--primary-color);
        }

        .category-btn.active i {
            color: #000;
        }

        /* Estilos para el estado de carga */
        .loading-state {
            text-align: center;
            padding: 2rem;
            color: var(--primary-color);
        }

        .loading-state i {
            font-size: 2rem;
            margin-bottom: 1rem;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .results-card {
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid rgba(56, 176, 0, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .league-header {
            text-align: center;
            padding: 1rem;
            border-bottom: 1px solid rgba(109, 235, 50, 0.1);
            margin-bottom: 1rem;
        }

        .league-header h3 {
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
        }

        .match-details {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2rem;
            width: 100%;
            padding: 1rem;
        }

        .team {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.8rem;
            min-width: 120px;
        }

        .team-logo {
            width: 60px;
            height: 60px;
            object-fit: contain;
            border-radius: 50%;
            padding: 5px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(109, 235, 50, 0.2);
        }

        .team span {
            text-align: center;
            font-weight: 500;
            font-size: 0.9rem;
        }

        .match-score {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
            background: rgba(109, 235, 50, 0.1);
            padding: 0.5rem 1.5rem;
            border-radius: 8px;
            min-width: 100px;
            text-align: center;
        }

        .prediction {
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(109, 235, 50, 0.05);
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .prediction .label {
            color: rgba(255, 255, 255, 0.7);
        }

        .prediction .value {
            color: var(--primary-color);
            font-weight: 600;
        }

        .success-icon, .failed-icon {
            margin-left: auto;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .success-icon {
            background: rgba(109, 235, 50, 0.1);
            color: var(--primary-color);
        }

        .failed-icon {
            background: rgba(255, 68, 68, 0.1);
            color: #ff4444;
        }

        @media (max-width: 480px) {
            .match-details {
                gap: 1rem;
            }
            
            .team {
                min-width: 80px;
            }
            
            .team-logo {
                width: 40px;
                height: 40px;
            }
            
            .match-score {
                font-size: 1.4rem;
                padding: 0.4rem 1rem;
                min-width: 80px;
            }
            
            .team span {
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="navbar-content">
            <div class="logo">
                <i class="fas fa-futbol"></i>
                <span>BOT DE PRONÓSTICOS HRZ</span>
            </div>
            <button onclick="cerrarSesion()" class="logout-btn">
                <i class="fas fa-sign-out-alt"></i>
                Cerrar Sesión
            </button>
        </div>
    </nav>

    <main class="main-content">
        <div class="welcome-card">
            <div class="user-info">
                <div class="user-header">
                    <div class="user-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="user-details">
                        <h1>Bienvenido, <span id="userName"></span></h1>
                        <div class="plan-badge">
                            <i class="fas fa-crown"></i>
                            <span id="userPlan"></span>
                        </div>
                    </div>
                </div>
                <div class="subscription-info">
                    <div class="info-item">
                        <i class="fas fa-calendar-check"></i>
                        <div class="info-text">
                            <span class="info-label">Válido hasta:</span>
                            <span id="validDate" class="info-value"></span>
                        </div>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-chart-line"></i>
                        <div class="info-text">
                            <span class="info-label">Estado:</span>
                            <span class="status-active">Activo</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-navigation">
            <button class="tab-btn active" data-section="pronosticos-section">
                <i class="fas fa-futbol"></i>
                <span>Pronósticos</span>
            </button>
            <button class="tab-btn" data-section="resultados-section">
                <i class="fas fa-poll"></i>
                <span>Resultados</span>
            </button>
            <button class="tab-btn" data-section="noticias-section">
                <i class="fas fa-newspaper"></i>
                <span>Noticias</span>
            </button>
        </div>
    </main>

    <div id="sections">
        <!-- Sección de Pronósticos -->
        <div id="pronosticos-section" class="content-section" style="display: none;">
            <div class="section-header">
                <h2><i class="fas fa-futbol"></i> Pronósticos del Día</h2>
            </div>
            <div class="section-content">
                <div class="prediction-card">
                    <h3><i class="fas fa-trophy"></i> Premier League</h3>
                    <p>Manchester City vs Liverpool</p>
                    <p class="prediction">Predicción: Over 2.5 goles</p>
                </div>
                <div class="prediction-card">
                    <h3><i class="fas fa-trophy"></i> La Liga</h3>
                    <p>Real Madrid vs Barcelona</p>
                    <p class="prediction">Predicción: Ambos equipos marcan</p>
                </div>
            </div>
        </div>

        <!-- Sección de Resultados -->
        <div id="resultados-section" class="content-section" style="display: none;">
            <div class="section-header">
                <h2><i class="fas fa-history"></i> Historial de Resultados</h2>
            </div>
            <div class="section-content">
                <!-- Aquí se cargarán los resultados -->
            </div>
        </div>

        <!-- Sección de Noticias -->
        <div id="noticias-section" class="content-section" style="display: none;">
            <div class="section-header">
                <h2><i class="fas fa-newspaper"></i> Últimas Noticias</h2>
            </div>
            
            <!-- Agregar navegación de categorías -->
            <div class="news-categories-nav">
                <button class="category-btn active" data-category="all">
                    <i class="fas fa-globe"></i> Todas
                </button>
                <button class="category-btn" data-category="selecciones">
                    <i class="fas fa-flag"></i> Selecciones
                </button>
                <button class="category-btn" data-category="laliga">
                    <i class="fas fa-futbol"></i> La Liga
                </button>
                <button class="category-btn" data-category="premier">
                    <i class="fas fa-trophy"></i> Premier
                </button>
                <button class="category-btn" data-category="champions">
                    <i class="fas fa-star"></i> Champions
                </button>
                <button class="category-btn" data-category="libertadores">
                    <i class="fas fa-globe-americas"></i> Libertadores
                </button>
                <button class="category-btn" data-category="bundesliga">
                    <i class="fas fa-shield-alt"></i> Bundesliga
                </button>
            </div>

            <div class="section-content" id="news-content">
                <!-- El contenido de las noticias se cargará aquí -->
            </div>
        </div>
    </div>

    <script>
        // Verificar si el usuario está autenticado
        function checkAuth() {
            if (!sessionStorage.getItem('userAuth')) {
                window.location.href = '../index.html';
            }
        }

        // Función para cerrar sesión
        function cerrarSesion() {
            sessionStorage.removeItem('userAuth');
            window.location.href = '../index.html';
        }

        // Prevenir navegación con el botón atrás
        window.history.pushState(null, null, window.location.href);
        window.onpopstate = function() {
            window.history.pushState(null, null, window.location.href);
        };

        // Verificar autenticación al cargar la página
        checkAuth();

        // Agregar después del checkAuth()
        function loadUserInfo() {
            const userName = sessionStorage.getItem('userName') || 'Usuario';
            const userPlan = sessionStorage.getItem('userPlan') || 'No disponible';
            const validDate = sessionStorage.getItem('validDate') || 'No disponible';
            
            // Actualizar el nombre de usuario
            document.getElementById('userName').textContent = userName;
            
            // Actualizar el plan
            document.getElementById('userPlan').textContent = userPlan;
            
            // Actualizar la fecha de validez
            if (validDate && validDate !== 'No disponible') {
                document.getElementById('validDate').textContent = validDate;
                document.getElementById('validDate').style.color = '#6deb32'; // Color verde para fecha válida
            } else {
                document.getElementById('validDate').textContent = 'No disponible';
                document.getElementById('validDate').style.color = '#ff3e3e'; // Color rojo para no disponible
            }
        }

        // Asegurarnos que la función se ejecute cuando la página cargue
        window.addEventListener('DOMContentLoaded', function() {
            checkAuth();
            loadUserInfo();
        });

        function showSection(sectionId) {
            // Ocultar todas las secciones
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Mostrar la sección seleccionada
            document.getElementById(sectionId).style.display = 'block';
            
            // Actualizar estados de las pestañas
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-section="${sectionId}"]`).classList.add('active');
        }

        // Modificar el event listener de las pestañas
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const sectionId = btn.dataset.section;
                showSection(sectionId);
                
                // Cargar el contenido correspondiente según la sección
                if (sectionId === 'noticias-section') {
                    fetchSportsNews('all');
                } else if (sectionId === 'resultados-section') {
                    loadResults(); // Cargar los resultados cuando se seleccione esa pestaña
                } else if (sectionId === 'pronosticos-section') {
                    loadPronosticos();
                }
            });
        });

        // Mostrar la primera sección por defecto
        showSection('pronosticos-section');

        // Función para obtener los pronósticos
        async function fetchPronosticos() {
            const today = new Date().toDateString();
            const cachedData = localStorage.getItem('pronosticosData');
            const cachedDate = localStorage.getItem('pronosticosDate');

            console.log('Fecha actual:', today);
            console.log('Datos en caché:', cachedData);
            console.log('Fecha en caché:', cachedDate);

            // Verificar si tenemos datos en caché del mismo día
            if (cachedData && cachedDate === today) {
                console.log('Usando datos en caché');
                return JSON.parse(cachedData);
            }

            // Si no hay datos en caché o son de otro día, hacer la solicitud
            try {
                console.log('Realizando nueva solicitud a la API');
                const url = 'https://magicloops.dev/api/loop/7452345e-6b58-4684-9cd4-c9aedaece13d/run';
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ "input": "I love Magic Loops!" })
                });

                const data = await response.json();
                console.log('Respuesta de la API:', data);
                
                // Guardar en localStorage
                localStorage.setItem('pronosticosData', JSON.stringify(data));
                localStorage.setItem('pronosticosDate', today);
                
                return data;
            } catch (error) {
                console.error('Error al obtener pronósticos:', error);
                return null;
            }
        }

        // Agregar el HTML del loader al inicio del body
        function addLoaderHTML() {
            const loaderHTML = `
                <div id="loader-overlay" style="
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.9);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 9999;
                ">
                    <div style="text-align: center; color: var(--primary-color);">
                        <div class="loader" style="
                            width: 50px;
                            height: 50px;
                            border: 3px solid var(--primary-color);
                            border-radius: 50%;
                            border-top-color: transparent;
                            margin: 0 auto 20px;
                            animation: spin 1s linear infinite;
                        "></div>
                        <p style="font-size: 1.2rem;">Cargando pronósticos...</p>
                    </div>
                </div>
                <style>
                    @keyframes spin {
                        0% { transform: rotate(0deg); }
                        100% { transform: rotate(360deg); }
                    }
                </style>
            `;
            document.body.insertAdjacentHTML('afterbegin', loaderHTML);
        }

        function showLoader() {
            addLoaderHTML();
        }

        function hideLoader() {
            const loader = document.getElementById('loader-overlay');
            if (loader) {
                loader.style.opacity = '0';
                loader.style.transition = 'opacity 0.3s ease';
                setTimeout(() => loader.remove(), 300);
            }
        }

        async function loadPronosticos() {
            console.log('Iniciando carga de pronósticos');
            showLoader();
            
            try {
                const data = await fetchPronosticos();
                console.log('Datos obtenidos:', data);
                
                if (data && data.matches) {
                    displayMatches(data.matches);
                } else {
                    const pronosticosContent = document.querySelector('#pronosticos-section .section-content');
                    if (pronosticosContent) {
                        pronosticosContent.innerHTML = `
                            <div class="prediction-card">
                                <h3><i class="fas fa-exclamation-triangle"></i> Sin datos</h3>
                                <p>No hay pronósticos disponibles en este momento.</p>
                            </div>
                        `;
                    }
                }
            } catch (error) {
                console.error('Error al cargar pronósticos:', error);
            } finally {
                hideLoader();
            }
        }

        function getStatusBadge(status) {
            const statusMap = {
                'Scheduled': {
                    text: 'Por comenzar',
                    color: '#ffd700',
                    icon: 'fa-clock'
                },
                'Live': {
                    text: 'En vivo',
                    color: '#ff4444',
                    icon: 'fa-circle'
                },
                'Finished': {
                    text: 'Finalizado',
                    color: '#4CAF50',
                    icon: 'fa-check-circle'
                }
            };

            const statusInfo = statusMap[status] || {
                text: status,
                color: '#999',
                icon: 'fa-info-circle'
            };

            return `
                <div class="status-badge" style="
                    display: inline-flex;
                    align-items: center;
                    gap: 5px;
                    background: rgba(${hexToRgb(statusInfo.color)}, 0.1);
                    padding: 5px 12px;
                    border-radius: 20px;
                    border: 1px solid ${statusInfo.color};
                ">
                    <i class="fas ${statusInfo.icon}" style="color: ${statusInfo.color}"></i>
                    <span style="color: ${statusInfo.color}">${statusInfo.text}</span>
                </div>
            `;
        }

        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? `${parseInt(result[1], 16)}, ${parseInt(result[2], 16)}, ${parseInt(result[3], 16)}` : '255, 255, 255';
        }

        async function getPrediction(match) {
            try {
                const API_KEY = 'AIzaSyCu6--GR8Hr1JV8PNlr5nEVNyjD51JvoEo';
                const prompt = `Actúa como un experto analista de fútbol. Analiza el siguiente partido y genera una predicción basada en estadísticas:

Partido: ${match.home_team.name} vs ${match.away_team.name}
Liga: ${match.league}

IMPORTANTE: Responde SOLAMENTE con un objeto JSON que tenga exactamente esta estructura (ajusta los números según tu análisis):
{
    "homeWinProb": 40,
    "awayWinProb": 30,
    "drawProb": 30,
    "over15Prob": 75,
    "over25Prob": 60,
    "predictedScore": "2-1",
    "reasoning": "Breve análisis del partido"
}`;

                const response = await fetch(
                    `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`,
                    {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{
                                    text: prompt
                                }]
                            }]
                        })
                    }
                );

                const data = await response.json();
                console.log('Respuesta de Gemini:', data); // Para debug

                if (!data.candidates || !data.candidates[0] || !data.candidates[0].content) {
                    throw new Error('Respuesta de API inválida');
                }

                const predictionText = data.candidates[0].content.parts[0].text;
                console.log('Texto de predicción:', predictionText); // Para debug

                // Buscar el JSON en la respuesta
                const jsonMatch = predictionText.match(/\{[\s\S]*\}/);
                if (!jsonMatch) {
                    throw new Error('No se encontró JSON en la respuesta');
                }

                const prediction = JSON.parse(jsonMatch[0]);
                console.log('Predicción parseada:', prediction); // Para debug

                return prediction;

            } catch (error) {
                console.error('Error específico:', error);
                throw error; // Re-lanzar el error en lugar de usar valores por defecto
            }
        }

        function displayMatches(matches) {
            const pronosticosContent = document.querySelector('#pronosticos-section .section-content');
            pronosticosContent.innerHTML = '';

            matches.forEach(async (match) => {
                const prediction = await getPrediction(match);
                
                // Normalizar probabilidades para que sumen 100%
                const total = prediction.homeWinProb + prediction.awayWinProb + prediction.drawProb;
                const homeWinNorm = (prediction.homeWinProb / total) * 100;
                const awayWinNorm = (prediction.awayWinProb / total) * 100;
                const drawNorm = (prediction.drawProb / total) * 100;

                const matchCard = `
                    <div class="prediction-card">
                        <div style="
                            display: flex;
                            align-items: center;
                            gap: 10px;
                            margin-bottom: 15px;
                        ">
                            <i class="fas fa-trophy" style="color: #6deb32"></i>
                            <h3 style="
                                color: #6deb32;
                                font-size: 1.2rem;
                                margin: 0;
                            ">${match.league}</h3>
                        </div>

                        <div style="
                            background: rgba(255, 255, 255, 0.05);
                            border-radius: 12px;
                            padding: 20px;
                            margin: 15px 0;
                        ">
                            <div style="
                                display: grid;
                                grid-template-columns: 1fr auto 1fr;
                                align-items: center;
                                gap: 10px;
                                @media (max-width: 768px) {
                                    grid-template-columns: 1fr;
                                    text-align: center;
                                }
                            ">
                                <!-- Equipo Local -->
                                <div style="
                                    display: flex;
                                    align-items: center;
                                    gap: 12px;
                                    @media (max-width: 768px) {
                                        justify-content: center;
                                    }
                                ">
                                    <img src="${match.home_team.logo}" 
                                         alt="${match.home_team.name}" 
                                         style="width: 40px; height: 40px;">
                                    <span>${match.home_team.name}</span>
                                </div>
                                
                                <!-- VS -->
                                <div style="
                                    text-align: center;
                                    font-weight: bold;
                                    color: #6deb32;
                                    @media (max-width: 768px) {
                                        margin: 10px 0;
                                    }
                                ">VS</div>
                                
                                <!-- Equipo Visitante -->
                                <div style="
                                    display: flex;
                                    align-items: center;
                                    gap: 12px;
                                    justify-content: flex-end;
                                    @media (max-width: 768px) {
                                        justify-content: center;
                                    }
                                ">
                                    <span>${match.away_team.name}</span>
                                    <img src="${match.away_team.logo}" 
                                         alt="${match.away_team.name}" 
                                         style="width: 40px; height: 40px;">
                                </div>
                            </div>
                        </div>

                        <div style="
                            display: flex;
                            flex-wrap: wrap;
                            gap: 15px;
                            margin-top: 15px;
                        ">
                            <div style="
                                display: flex;
                                align-items: center;
                                gap: 8px;
                                background: rgba(255, 255, 255, 0.05);
                                padding: 8px 15px;
                                border-radius: 20px;
                            ">
                                <i class="fas fa-map-marker-alt" style="color: #6deb32"></i>
                                <span style="color: #fff; font-size: 0.9rem;">${match.stadium}</span>
                            </div>
                            
                            <div style="
                                display: flex;
                                align-items: center;
                                gap: 8px;
                                background: rgba(255, 255, 255, 0.05);
                                padding: 8px 15px;
                                border-radius: 20px;
                            ">
                                <i class="fas fa-clock" style="color: #6deb32"></i>
                                <span style="color: #fff; font-size: 0.9rem;">${match.time}</span>
                            </div>
                        </div>

                        <div style="margin-top: 15px;">
                            ${getStatusBadge(match.status)}
                        </div>

                        <div class="prediction-details" style="margin-top: 20px;">
                            <h4 style="color: #6deb32; margin-bottom: 15px;">Predicción del Partido</h4>
                            
                            <!-- Barra de probabilidades -->
                            <div class="probability-bar" style="
                                height: 20px;
                                border-radius: 10px;
                                overflow: hidden;
                                margin-bottom: 15px;
                                display: flex;
                            ">
                                <div style="
                                    width: ${homeWinNorm}%;
                                    background: #6deb32;
                                    height: 100%;
                                " title="${match.home_team.name} Victoria (${homeWinNorm.toFixed(1)}%)"></div>
                                <div style="
                                    width: ${drawNorm}%;
                                    background: #ffd700;
                                    height: 100%;
                                " title="Empate (${drawNorm.toFixed(1)}%)"></div>
                                <div style="
                                    width: ${awayWinNorm}%;
                                    background: #ff4444;
                                    height: 100%;
                                " title="${match.away_team.name} Victoria (${awayWinNorm.toFixed(1)}%)"></div>
                            </div>

                            <!-- Leyenda -->
                            <div class="probability-legend" style="
                                display: flex;
                                justify-content: space-between;
                                margin-bottom: 20px;
                                font-size: 0.9rem;
                            ">
                                <span style="color: #6deb32;">
                                    ${match.home_team.name} (${homeWinNorm.toFixed(1)}%)
                                </span>
                                <span style="color: #ffd700;">
                                    Empate (${drawNorm.toFixed(1)}%)
                                </span>
                                <span style="color: #ff4444;">
                                    ${match.away_team.name} (${awayWinNorm.toFixed(1)}%)
                                </span>
                            </div>

                            <!-- Predicciones adicionales -->
                            <div class="additional-predictions" style="
                                display: grid;
                                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                                gap: 15px;
                                margin-top: 20px;
                            ">
                                <div class="prediction-item" style="
                                    background: rgba(109, 235, 50, 0.1);
                                    padding: 15px;
                                    border-radius: 10px;
                                    border: 1px solid rgba(109, 235, 50, 0.2);
                                ">
                                    <h5 style="color: #6deb32; margin-bottom: 10px;">
                                        <i class="fas fa-futbol"></i> Más de 1.5 goles
                                    </h5>
                                    <span style="font-size: 1.2rem; color: #fff;">
                                        ${prediction.over15Prob.toFixed(1)}%
                                    </span>
                                </div>

                                <div class="prediction-item" style="
                                    background: rgba(109, 235, 50, 0.1);
                                    padding: 15px;
                                    border-radius: 10px;
                                    border: 1px solid rgba(109, 235, 50, 0.2);
                                ">
                                    <h5 style="color: #6deb32; margin-bottom: 10px;">
                                        <i class="fas fa-chart-line"></i> Más de 2.5 goles
                                    </h5>
                                    <span style="font-size: 1.2rem; color: #fff;">
                                        ${prediction.over25Prob.toFixed(1)}%
                                    </span>
                                </div>

                                <div class="prediction-item" style="
                                    background: rgba(109, 235, 50, 0.1);
                                    padding: 15px;
                                    border-radius: 10px;
                                    border: 1px solid rgba(109, 235, 50, 0.2);
                                ">
                                    <h5 style="color: #6deb32; margin-bottom: 10px;">
                                        <i class="fas fa-bullseye"></i> Resultado Probable
                                    </h5>
                                    <span style="font-size: 1.2rem; color: #fff;">
                                        ${prediction.predictedScore}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                pronosticosContent.innerHTML += matchCard;
            });
        }

        // Asegurarnos que la sección de pronósticos esté visible al inicio
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Página cargada');
            checkAuth();
            loadUserInfo();
            showSection('pronosticos-section'); // Mostrar la sección de pronósticos
            loadPronosticos();
        });

        // Agregar después de las funciones existentes
        async function fetchSportsNews(category = 'all') {
            const newsSection = document.querySelector('#news-content');
            newsSection.innerHTML = '<div class="loading-state"><i class="fas fa-spinner"></i><p>Cargando noticias...</p></div>';

            const categories = {
                all: { name: 'Todas las Noticias', icon: 'fas fa-globe' },
                selecciones: {
                    name: 'Selecciones Nacionales',
                    url: 'https://www.marca.com/rss/futbol/seleccion.xml',
                    icon: 'fas fa-flag'
                },
                laliga: {
                    name: 'La Liga',
                    url: 'https://www.marca.com/rss/futbol/primera-division.xml',
                    icon: 'fas fa-futbol'
                },
                premier: {
                    name: 'Premier League',
                    url: 'https://www.marca.com/rss/futbol/premier-league.xml',
                    icon: 'fas fa-trophy'
                },
                champions: {
                    name: 'Champions League',
                    url: 'https://www.marca.com/rss/futbol/champions-league.xml',
                    icon: 'fas fa-star'
                },
                libertadores: {
                    name: 'Copa Libertadores',
                    url: 'https://www.marca.com/rss/futbol/futbol-internacional.xml',
                    icon: 'fas fa-globe-americas'
                },
                bundesliga: {
                    name: 'Bundesliga',
                    url: 'https://www.marca.com/rss/futbol/bundesliga.xml',
                    icon: 'fas fa-shield-alt'
                }
            };

            try {
                if (category === 'all') {
                    // Cargar una vista previa de cada categoría
                    let allNewsHTML = '';
                    for (const [key, cat] of Object.entries(categories)) {
                        if (key !== 'all') {
                            const news = await fetchRSSFeed(cat.url);
                            if (news.length > 0) {
                                allNewsHTML += `
                                    <div class="news-category">
                                        <h3 class="category-title">
                                            <i class="${cat.icon}"></i> ${cat.name}
                                            <button class="view-more-btn" onclick="fetchSportsNews('${key}')">
                                                Ver más <i class="fas fa-arrow-right"></i>
                                            </button>
                                        </h3>
                                        <div class="news-grid">
                                            ${news.slice(0, 2).map(item => createNewsCard(item)).join('')}
                                        </div>
                                    </div>
                                `;
                            }
                        }
                    }
                    newsSection.innerHTML = allNewsHTML;
                } else {
                    // Cargar noticias de una categoría específica
                    const categoryInfo = categories[category];
                    const news = await fetchRSSFeed(categoryInfo.url);
                    
                    newsSection.innerHTML = `
                        <div class="news-category">
                            <h3 class="category-title">
                                <i class="${categoryInfo.icon}"></i> ${categoryInfo.name}
                            </h3>
                            <div class="news-grid">
                                ${news.map(item => createNewsCard(item)).join('')}
                            </div>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error al cargar las noticias:', error);
                newsSection.innerHTML = `
                    <div class="news-card">
                        <h3><i class="fas fa-exclamation-triangle"></i> Error</h3>
                        <p>No se pudieron cargar las noticias. Por favor, intenta más tarde.</p>
                    </div>
                `;
            }
        }

        // Agregar event listeners para los botones de categoría
        document.addEventListener('DOMContentLoaded', function() {
            const categoryButtons = document.querySelectorAll('.category-btn');
            const newsContent = document.getElementById('news-content');

            // Función para mostrar estado de carga
            function showLoading() {
                newsContent.innerHTML = `
                    <div class="loading-state">
                        <i class="fas fa-spinner"></i>
                        <p>Cargando noticias...</p>
                    </div>
                `;
            }

            // Función para manejar errores
            function showError(message) {
                newsContent.innerHTML = `
                    <div class="loading-state">
                        <i class="fas fa-exclamation-circle"></i>
                        <p>${message}</p>
                    </div>
                `;
            }

            // Mejorar el manejo de clics en categorías
            categoryButtons.forEach(button => {
                button.addEventListener('click', async function(e) {
                    e.preventDefault();
                    
                    // Actualizar estados de los botones
                    categoryButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    
                    const category = this.dataset.category;
                    
                    try {
                        showLoading();
                        await fetchSportsNews(category);
                    } catch (error) {
                        showError('Error al cargar las noticias. Por favor, intenta de nuevo.');
                        console.error('Error:', error);
                    }
                });
            });

            // Mejorar el botón "Ver más"
            document.querySelectorAll('.view-more-btn').forEach(btn => {
                btn.addEventListener('click', async function(e) {
                    e.preventDefault();
                    
                    const category = this.dataset.category;
                    const categoryButton = document.querySelector(`[data-category="${category}"]`);
                    
                    if (categoryButton) {
                        categoryButton.click();
                        
                        // Scroll suave hasta la sección de noticias
                        document.getElementById('noticias-section').scrollIntoView({
                            behavior: 'smooth'
                        });
                    }
                });
            });
        });

        // Actualizar la función createNewsCard
        function createNewsCard(item) {
            const category = item.category || 'Deportes';
            return `
                <div class="news-card">
                    <div class="news-image">
                        <img src="${item.image}" alt="${item.title}">
                    </div>
                    <div class="news-content">
                        <div>
                            <span class="news-category-tag">
                                <i class="fas fa-futbol"></i>
                                ${category}
                            </span>
                            <h3 class="news-title">${item.title}</h3>
                            <p class="news-excerpt">${item.description.replace(/<[^>]*>/g, '').substring(0, 120)}...</p>
                        </div>
                        <div class="news-meta">
                            <span class="news-date">
                                <i class="far fa-clock"></i>
                                ${formatDate(item.pubDate)}
                            </span>
                            <a href="${item.link}" target="_blank" class="read-more">
                                Leer más
                                <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                    </div>
                </div>
            `;
        }

        // Actualizar la función formatDate para un formato más elegante
        function formatDate(date) {
            const options = {
                day: 'numeric',
                month: 'long',
                year: 'numeric'
            };
            return new Date(date).toLocaleDateString('es-ES', options);
        }

        // Modificar la función fetchRSSFeed para usar un servicio de proxy más confiable
        async function fetchRSSFeed(url) {
            try {
                // Usar rss2json como servicio alternativo
                const apiUrl = `https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(url)}`;
                const response = await fetch(apiUrl);
                const data = await response.json();
                
                if (data.status === 'ok') {
                    return data.items.map(item => ({
                        title: item.title,
                        description: item.description,
                        link: item.link,
                        pubDate: new Date(item.pubDate),
                        image: item.enclosure?.link || item.thumbnail || 'https://via.placeholder.com/400x300?text=Noticia+Deportiva'
                    }));
                }
                return [];
            } catch (error) {
                console.error('Error al obtener el feed RSS:', error);
                return [];
            }
        }

        function clearResultsCache() {
            const cachedTimestamp = localStorage.getItem('resultsTimestamp');
            if (cachedTimestamp) {
                const now = new Date().getTime();
                const timeDiff = now - parseInt(cachedTimestamp);
                const threeHours = 3 * 60 * 60 * 1000;
                
                if (timeDiff >= threeHours) {
                    localStorage.removeItem('resultsData');
                    localStorage.removeItem('resultsTimestamp');
                    console.log('Caché de resultados borrado por tiempo expirado');
                }
            }
        }

        async function fetchResults() {
            const now = new Date();
            const cachedData = localStorage.getItem('resultsData');
            const cachedTimestamp = localStorage.getItem('resultsTimestamp');

            // Verificar si hay datos en caché y si no han pasado 3 horas
            if (cachedData && cachedTimestamp) {
                const timeDiff = now.getTime() - parseInt(cachedTimestamp);
                const threeHours = 3 * 60 * 60 * 1000; // 3 horas en milisegundos
                
                if (timeDiff < threeHours) {
                    console.log('Usando datos en caché');
                    return JSON.parse(cachedData);
                }
            }

            try {
                console.log('Realizando nueva solicitud de resultados a la API');
                const url = 'https://magicloops.dev/api/loop/fbdd9b60-f514-4974-bf67-08c2c831f242/run';
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ "input": "I love Magic Loops!" })
                });

                if (!response.ok) {
                    throw new Error('Error en la respuesta de la API');
                }

                const data = await response.json();
                console.log('Respuesta de la API de resultados:', data);
                
                const transformedData = {
                    results: data.matches.map(match => ({
                        league: match.league || 'Liga no especificada',
                        home_team: match.team1,
                        away_team: match.team2,
                        score: match.result || 'VS',
                        logo1: match.logo1,
                        logo2: match.logo2
                    }))
                };
                
                // Guardar en caché con timestamp
                localStorage.setItem('resultsData', JSON.stringify(transformedData));
                localStorage.setItem('resultsTimestamp', now.getTime().toString());
                
                return transformedData;
            } catch (error) {
                console.error('Error al obtener resultados:', error);
                // Si hay error, intentar usar datos en caché aunque hayan pasado 3 horas
                if (cachedData) {
                    console.log('Usando datos en caché debido a error en la API');
                    return JSON.parse(cachedData);
                }
                return null;
            }
        }

        async function loadResults() {
            console.log('Iniciando carga de resultados');
            showLoader();
            
            try {
                clearResultsCache(); // Solo limpiará si han pasado 3 horas
                const data = await fetchResults();
                console.log('Resultados obtenidos:', data);
                
                if (data && data.results) {
                    displayResults(data.results);
                } else {
                    const resultsContent = document.querySelector('#resultados-section .section-content');
                    if (resultsContent) {
                        resultsContent.innerHTML = `
                            <div class="results-card">
                                <h3><i class="fas fa-exclamation-triangle"></i> Sin datos</h3>
                                <p>No hay resultados disponibles en este momento.</p>
                            </div>
                        `;
                    }
                }
            } catch (error) {
                console.error('Error al cargar resultados:', error);
            } finally {
                hideLoader();
            }
        }

        function displayResults(results) {
            const resultsContent = document.querySelector('#resultados-section .section-content');
            if (!resultsContent) return;

            if (!results || results.length === 0) {
                resultsContent.innerHTML = `
                    <div class="results-card">
                        <h3><i class="fas fa-exclamation-triangle"></i> Sin datos</h3>
                        <p>No hay resultados disponibles en este momento.</p>
                    </div>
                `;
                return;
            }

            const resultsHTML = results.map(result => `
                <div class="results-card">
                    <div class="league-header">
                        <i class="fas fa-trophy"></i>
                        <h3>${result.league}</h3>
                    </div>
                    <div class="result-item">
                        <div class="match-details">
                            <div class="team">
                                <img src="${result.logo1}" 
                                     alt="${result.home_team}" 
                                     class="team-logo"
                                     onerror="this.src='https://via.placeholder.com/60/1a1a1a/6deb32?text=⚽'">
                                <span>${result.home_team}</span>
                            </div>
                            <div class="match-score">
                                ${result.score}
                            </div>
                            <div class="team">
                                <img src="${result.logo2}" 
                                     alt="${result.away_team}" 
                                     class="team-logo"
                                     onerror="this.src='https://via.placeholder.com/60/1a1a1a/6deb32?text=⚽'">
                                <span>${result.away_team}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');

            resultsContent.innerHTML = resultsHTML;
        }
    </script>
</body>
</html>
